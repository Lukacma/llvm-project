; NOTE: Assertions have been autogenerated by utils/update_llc_test_checks.py UTC_ARGS: --version 5
; RUN: llc < %s -mtriple aarch64-unknown-unknown -mattr=+fullfp16 | FileCheck %s --check-prefixes=CHECK-NOFPRCVT
; RUN: llc < %s -mtriple aarch64-unknown-unknown -mattr=+fprcvt,+fullfp16 | FileCheck %s --check-prefixes=CHECK,CHECK-SD
; RUN: llc < %s -mtriple aarch64-unknown-unknown -global-isel -global-isel-abort=2 -mattr=+fprcvt,+fullfp16 2>&1  | FileCheck %s --check-prefixes=CHECK,CHECK-GI

; CHECK-GI: warning: Instruction selection used fallback path for fptosi_i32_f16_simd
; CHECK-GI-NEXT: warning: Instruction selection used fallback path for fptosi_i64_f16_simd
; CHECK-GI-NEXT: warning: Instruction selection used fallback path for fptosi_i64_f32_simd
; CHECK-GI-NEXT: warning: Instruction selection used fallback path for fptosi_i32_f64_simd
; CHECK-GI-NEXT: warning: Instruction selection used fallback path for fptosi_i64_f64_simd
; CHECK-GI-NEXT: warning: Instruction selection used fallback path for fptosi_i32_f32_simd
; CHECK-GI-NEXT: warning: Instruction selection used fallback path for fptoui_i32_f16_simd
; CHECK-GI-NEXT: warning: Instruction selection used fallback path for fptoui_i64_f16_simd
; CHECK-GI-NEXT: warning: Instruction selection used fallback path for fptoui_i64_f32_simd
; CHECK-GI-NEXT: warning: Instruction selection used fallback path for fptoui_i32_f64_simd
; CHECK-GI-NEXT: warning: Instruction selection used fallback path for fptoui_i64_f64_simd
; CHECK-GI-NEXT: warning: Instruction selection used fallback path for fptoui_i32_f32_simd

;
; FPTOI
;

define float @test_fptosi_f16_i32_simd(half %a)  {
; CHECK-NOFPRCVT-LABEL: test_fptosi_f16_i32_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzs w8, h0
; CHECK-NOFPRCVT-NEXT:    fmov s0, w8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-LABEL: test_fptosi_f16_i32_simd:
; CHECK:       // %bb.0:
; CHECK-NEXT:    fcvtzs s0, h0
; CHECK-NEXT:    ret
  %r = fptosi half %a to i32
  %bc = bitcast i32 %r to float
  ret float %bc
}

define double @test_fptosi_f16_i64_simd(half %a)  {
; CHECK-NOFPRCVT-LABEL: test_fptosi_f16_i64_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzs x8, h0
; CHECK-NOFPRCVT-NEXT:    fmov d0, x8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-LABEL: test_fptosi_f16_i64_simd:
; CHECK:       // %bb.0:
; CHECK-NEXT:    fcvtzs d0, h0
; CHECK-NEXT:    ret
  %r = fptosi half %a to i64
  %bc = bitcast i64 %r to double
  ret double %bc
}

define float @test_fptosi_f64_i32_simd(double %a)  {
; CHECK-NOFPRCVT-LABEL: test_fptosi_f64_i32_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzs w8, d0
; CHECK-NOFPRCVT-NEXT:    fmov s0, w8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-LABEL: test_fptosi_f64_i32_simd:
; CHECK:       // %bb.0:
; CHECK-NEXT:    fcvtzs s0, d0
; CHECK-NEXT:    ret
  %r = fptosi double %a to i32
  %bc = bitcast i32 %r to float
  ret float %bc
}

define double @test_fptosi_f32_i64_simd(float %a)  {
; CHECK-NOFPRCVT-LABEL: test_fptosi_f32_i64_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzs x8, s0
; CHECK-NOFPRCVT-NEXT:    fmov d0, x8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-LABEL: test_fptosi_f32_i64_simd:
; CHECK:       // %bb.0:
; CHECK-NEXT:    fcvtzs d0, s0
; CHECK-NEXT:    ret
  %r = fptosi float %a to i64
  %bc = bitcast i64 %r to double
  ret double %bc
}

define double @test_fptosi_f64_i64_simd(double %a)  {
; CHECK-NOFPRCVT-LABEL: test_fptosi_f64_i64_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzs d0, d0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-LABEL: test_fptosi_f64_i64_simd:
; CHECK:       // %bb.0:
; CHECK-NEXT:    fcvtzs d0, d0
; CHECK-NEXT:    ret
  %r = fptosi double %a to i64
  %bc = bitcast i64 %r to double
  ret double %bc
}


define float @test_fptosi_f32_i32_simd(float %a)  {
; CHECK-NOFPRCVT-LABEL: test_fptosi_f32_i32_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzs s0, s0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-LABEL: test_fptosi_f32_i32_simd:
; CHECK:       // %bb.0:
; CHECK-NEXT:    fcvtzs s0, s0
; CHECK-NEXT:    ret
  %r = fptosi float %a to i32
  %bc = bitcast i32 %r to float
  ret float %bc
}

define float @test_fptoui_f16_i32_simd(half %a)  {
; CHECK-NOFPRCVT-LABEL: test_fptoui_f16_i32_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzu w8, h0
; CHECK-NOFPRCVT-NEXT:    fmov s0, w8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-LABEL: test_fptoui_f16_i32_simd:
; CHECK:       // %bb.0:
; CHECK-NEXT:    fcvtzu s0, h0
; CHECK-NEXT:    ret
  %r = fptoui half %a to i32
  %bc = bitcast i32 %r to float
  ret float %bc
}

define double @test_fptoui_f16_i64_simd(half %a)  {
; CHECK-NOFPRCVT-LABEL: test_fptoui_f16_i64_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzu x8, h0
; CHECK-NOFPRCVT-NEXT:    fmov d0, x8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-LABEL: test_fptoui_f16_i64_simd:
; CHECK:       // %bb.0:
; CHECK-NEXT:    fcvtzu d0, h0
; CHECK-NEXT:    ret
  %r = fptoui half %a to i64
  %bc = bitcast i64 %r to double
  ret double %bc
}

define float @test_fptoui_f64_i32_simd(double %a)  {
; CHECK-NOFPRCVT-LABEL: test_fptoui_f64_i32_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzu w8, d0
; CHECK-NOFPRCVT-NEXT:    fmov s0, w8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-LABEL: test_fptoui_f64_i32_simd:
; CHECK:       // %bb.0:
; CHECK-NEXT:    fcvtzu s0, d0
; CHECK-NEXT:    ret
  %r = fptoui double %a to i32
  %bc = bitcast i32 %r to float
  ret float %bc
}

define double @test_fptoui_f32_i64_simd(float %a)  {
; CHECK-NOFPRCVT-LABEL: test_fptoui_f32_i64_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzu x8, s0
; CHECK-NOFPRCVT-NEXT:    fmov d0, x8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-LABEL: test_fptoui_f32_i64_simd:
; CHECK:       // %bb.0:
; CHECK-NEXT:    fcvtzu d0, s0
; CHECK-NEXT:    ret
  %r = fptoui float %a to i64
  %bc = bitcast i64 %r to double
  ret double %bc
}

define double @test_fptoui_f64_i64_simd(double %a)  {
; CHECK-NOFPRCVT-LABEL: test_fptoui_f64_i64_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzu d0, d0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-LABEL: test_fptoui_f64_i64_simd:
; CHECK:       // %bb.0:
; CHECK-NEXT:    fcvtzu d0, d0
; CHECK-NEXT:    ret
  %r = fptoui double %a to i64
  %bc = bitcast i64 %r to double
  ret double %bc
}


define float @test_fptoui_f32_i32_simd(float %a)  {
; CHECK-NOFPRCVT-LABEL: test_fptoui_f32_i32_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzu s0, s0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-LABEL: test_fptoui_f32_i32_simd:
; CHECK:       // %bb.0:
; CHECK-NEXT:    fcvtzu s0, s0
; CHECK-NEXT:    ret
  %r = fptoui float %a to i32
  %bc = bitcast i32 %r to float
  ret float %bc
}


;
; FPTOI experimental
;

define float @fptosi_i32_f16_simd(half %x)  {
; CHECK-NOFPRCVT-LABEL: fptosi_i32_f16_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzs w8, h0
; CHECK-NOFPRCVT-NEXT:    fmov s0, w8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-LABEL: fptosi_i32_f16_simd:
; CHECK:       // %bb.0:
; CHECK-NEXT:    fcvtzs s0, h0
; CHECK-NEXT:    ret
  %val = call i32 @llvm.experimental.constrained.fptosi.i32.f16(half %x, metadata !"fpexcept.strict")
  %sum = bitcast i32 %val to float
  ret float %sum
}

define double @fptosi_i64_f16_simd(half %x)  {
; CHECK-NOFPRCVT-LABEL: fptosi_i64_f16_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzs x8, h0
; CHECK-NOFPRCVT-NEXT:    fmov d0, x8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-LABEL: fptosi_i64_f16_simd:
; CHECK:       // %bb.0:
; CHECK-NEXT:    fcvtzs d0, h0
; CHECK-NEXT:    ret
  %val = call i64 @llvm.experimental.constrained.fptosi.i64.f16(half %x, metadata !"fpexcept.strict")
  %sum = bitcast i64 %val to double
  ret double %sum
}

define double @fptosi_i64_f32_simd(float %x)  {
; CHECK-NOFPRCVT-LABEL: fptosi_i64_f32_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzs x8, s0
; CHECK-NOFPRCVT-NEXT:    fmov d0, x8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-LABEL: fptosi_i64_f32_simd:
; CHECK:       // %bb.0:
; CHECK-NEXT:    fcvtzs d0, s0
; CHECK-NEXT:    ret
  %val = call i64 @llvm.experimental.constrained.fptosi.i64.f32(float %x, metadata !"fpexcept.strict")
  %bc = bitcast i64 %val to double
  ret double %bc
}

define float @fptosi_i32_f64_simd(double %x)  {
; CHECK-NOFPRCVT-LABEL: fptosi_i32_f64_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzs w8, d0
; CHECK-NOFPRCVT-NEXT:    fmov s0, w8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-LABEL: fptosi_i32_f64_simd:
; CHECK:       // %bb.0:
; CHECK-NEXT:    fcvtzs s0, d0
; CHECK-NEXT:    ret
  %val = call i32 @llvm.experimental.constrained.fptosi.i32.f64(double %x, metadata !"fpexcept.strict")
  %bc = bitcast i32 %val to float
  ret float %bc
}

define double @fptosi_i64_f64_simd(double %x)  {
; CHECK-NOFPRCVT-LABEL: fptosi_i64_f64_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzs d0, d0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-LABEL: fptosi_i64_f64_simd:
; CHECK:       // %bb.0:
; CHECK-NEXT:    fcvtzs d0, d0
; CHECK-NEXT:    ret
  %val = call i64 @llvm.experimental.constrained.fptosi.i64.f64(double %x, metadata !"fpexcept.strict")
  %bc = bitcast i64 %val to double
  ret double %bc
}

define float @fptosi_i32_f32_simd(float %x)  {
; CHECK-NOFPRCVT-LABEL: fptosi_i32_f32_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzs s0, s0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-LABEL: fptosi_i32_f32_simd:
; CHECK:       // %bb.0:
; CHECK-NEXT:    fcvtzs s0, s0
; CHECK-NEXT:    ret
  %val = call i32 @llvm.experimental.constrained.fptosi.i32.f32(float %x, metadata !"fpexcept.strict")
  %bc = bitcast i32 %val to float
  ret float %bc
}



define float @fptoui_i32_f16_simd(half %x)  {
; CHECK-NOFPRCVT-LABEL: fptoui_i32_f16_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzu w8, h0
; CHECK-NOFPRCVT-NEXT:    fmov s0, w8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-LABEL: fptoui_i32_f16_simd:
; CHECK:       // %bb.0:
; CHECK-NEXT:    fcvtzu s0, h0
; CHECK-NEXT:    ret
  %val = call i32 @llvm.experimental.constrained.fptoui.i32.f16(half %x, metadata !"fpexcept.strict")
  %sum = bitcast i32 %val to float
  ret float %sum
}

define double @fptoui_i64_f16_simd(half %x)  {
; CHECK-NOFPRCVT-LABEL: fptoui_i64_f16_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzu x8, h0
; CHECK-NOFPRCVT-NEXT:    fmov d0, x8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-LABEL: fptoui_i64_f16_simd:
; CHECK:       // %bb.0:
; CHECK-NEXT:    fcvtzu d0, h0
; CHECK-NEXT:    ret
  %val = call i64 @llvm.experimental.constrained.fptoui.i64.f16(half %x, metadata !"fpexcept.strict")
  %sum = bitcast i64 %val to double
  ret double %sum
}

define double @fptoui_i64_f32_simd(float %x)  {
; CHECK-NOFPRCVT-LABEL: fptoui_i64_f32_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzu x8, s0
; CHECK-NOFPRCVT-NEXT:    fmov d0, x8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-LABEL: fptoui_i64_f32_simd:
; CHECK:       // %bb.0:
; CHECK-NEXT:    fcvtzu d0, s0
; CHECK-NEXT:    ret
  %val = call i64 @llvm.experimental.constrained.fptoui.i64.f32(float %x, metadata !"fpexcept.strict")
  %bc = bitcast i64 %val to double
  ret double %bc
}

define float @fptoui_i32_f64_simd(double %x)  {
; CHECK-NOFPRCVT-LABEL: fptoui_i32_f64_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzu w8, d0
; CHECK-NOFPRCVT-NEXT:    fmov s0, w8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-LABEL: fptoui_i32_f64_simd:
; CHECK:       // %bb.0:
; CHECK-NEXT:    fcvtzu s0, d0
; CHECK-NEXT:    ret
  %val = call i32 @llvm.experimental.constrained.fptoui.i32.f64(double %x, metadata !"fpexcept.strict")
  %bc = bitcast i32 %val to float
  ret float %bc
}

define double @fptoui_i64_f64_simd(double %x)  {
; CHECK-NOFPRCVT-LABEL: fptoui_i64_f64_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzu d0, d0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-LABEL: fptoui_i64_f64_simd:
; CHECK:       // %bb.0:
; CHECK-NEXT:    fcvtzu d0, d0
; CHECK-NEXT:    ret
  %val = call i64 @llvm.experimental.constrained.fptoui.i64.f64(double %x, metadata !"fpexcept.strict")
  %bc = bitcast i64 %val to double
  ret double %bc
}

define float @fptoui_i32_f32_simd(float %x)  {
; CHECK-NOFPRCVT-LABEL: fptoui_i32_f32_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzu s0, s0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-LABEL: fptoui_i32_f32_simd:
; CHECK:       // %bb.0:
; CHECK-NEXT:    fcvtzu s0, s0
; CHECK-NEXT:    ret
  %val = call i32 @llvm.experimental.constrained.fptoui.i32.f32(float %x, metadata !"fpexcept.strict")
  %bc = bitcast i32 %val to float
  ret float %bc
}

;
; FPTOI rounding
;


define double @fcvtas_ds_round_simd(float %a) {
; CHECK-NOFPRCVT-LABEL: fcvtas_ds_round_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtas x8, s0
; CHECK-NOFPRCVT-NEXT:    fmov d0, x8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtas_ds_round_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtas d0, s0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtas_ds_round_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl roundf
; CHECK-GI-NEXT:    fcvtzs d0, s0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call float @roundf(float %a) nounwind readnone
  %i = fptosi float %r to i64
  %bc = bitcast i64 %i to double
  ret double %bc
}

define float @fcvtas_sd_round_simd(double %a) {
; CHECK-NOFPRCVT-LABEL: fcvtas_sd_round_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtas w8, d0
; CHECK-NOFPRCVT-NEXT:    fmov s0, w8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtas_sd_round_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtas s0, d0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtas_sd_round_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl round
; CHECK-GI-NEXT:    fcvtzs s0, d0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call double @round(double %a) nounwind readnone
  %i = fptosi double %r to i32
  %bc = bitcast i32 %i to float
  ret float %bc
}

define float @fcvtas_ss_round_simd(float %a) {
; CHECK-NOFPRCVT-LABEL: fcvtas_ss_round_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtas s0, s0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtas_ss_round_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtas s0, s0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtas_ss_round_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl roundf
; CHECK-GI-NEXT:    fcvtzs s0, s0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call float @roundf(float %a) nounwind readnone
  %i = fptosi float %r to i32
  %bc = bitcast i32 %i to float
  ret float %bc
}

define double @fcvtas_dd_round_simd(double %a) {
; CHECK-NOFPRCVT-LABEL: fcvtas_dd_round_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtas d0, d0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtas_dd_round_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtas d0, d0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtas_dd_round_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl round
; CHECK-GI-NEXT:    fcvtzs d0, d0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call double @round(double %a) nounwind readnone
  %i = fptosi double %r to i64
  %bc = bitcast i64 %i to double
  ret double %bc
}


define double @fcvtau_ds_round_simd(float %a) {
; CHECK-NOFPRCVT-LABEL: fcvtau_ds_round_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtau x8, s0
; CHECK-NOFPRCVT-NEXT:    fmov d0, x8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtau_ds_round_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtau d0, s0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtau_ds_round_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl roundf
; CHECK-GI-NEXT:    fcvtzu d0, s0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call float @roundf(float %a) nounwind readnone
  %i = fptoui float %r to i64
  %bc = bitcast i64 %i to double
  ret double %bc
}

define float @fcvtau_sd_round_simd(double %a) {
; CHECK-NOFPRCVT-LABEL: fcvtau_sd_round_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtau w8, d0
; CHECK-NOFPRCVT-NEXT:    fmov s0, w8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtau_sd_round_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtau s0, d0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtau_sd_round_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl round
; CHECK-GI-NEXT:    fcvtzu s0, d0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call double @round(double %a) nounwind readnone
  %i = fptoui double %r to i32
  %bc = bitcast i32 %i to float
  ret float %bc
}

define float @fcvtau_ss_round_simd(float %a) {
; CHECK-NOFPRCVT-LABEL: fcvtau_ss_round_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtas s0, s0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtau_ss_round_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtas s0, s0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtau_ss_round_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl roundf
; CHECK-GI-NEXT:    fcvtzs s0, s0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call float @roundf(float %a) nounwind readnone
  %i = fptosi float %r to i32
  %bc = bitcast i32 %i to float
  ret float %bc
}

define double @fcvtau_dd_round_simd(double %a) {
; CHECK-NOFPRCVT-LABEL: fcvtau_dd_round_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtas d0, d0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtau_dd_round_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtas d0, d0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtau_dd_round_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl round
; CHECK-GI-NEXT:    fcvtzs d0, d0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call double @round(double %a) nounwind readnone
  %i = fptosi double %r to i64
  %bc = bitcast i64 %i to double
  ret double %bc
}


define double @fcvtms_ds_round_simd(float %a) {
; CHECK-NOFPRCVT-LABEL: fcvtms_ds_round_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtms x8, s0
; CHECK-NOFPRCVT-NEXT:    fmov d0, x8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtms_ds_round_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtms d0, s0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtms_ds_round_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl floorf
; CHECK-GI-NEXT:    fcvtzs d0, s0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call float @floorf(float %a) nounwind readnone
  %i = fptosi float %r to i64
  %bc = bitcast i64 %i to double
  ret double %bc
}

define float @fcvtms_sd_round_simd(double %a) {
; CHECK-NOFPRCVT-LABEL: fcvtms_sd_round_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtms w8, d0
; CHECK-NOFPRCVT-NEXT:    fmov s0, w8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtms_sd_round_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtms s0, d0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtms_sd_round_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl floor
; CHECK-GI-NEXT:    fcvtzs s0, d0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call double @floor(double %a) nounwind readnone
  %i = fptosi double %r to i32
  %bc = bitcast i32 %i to float
  ret float %bc
}

define float @fcvtms_ss_round_simd(float %a) {
; CHECK-NOFPRCVT-LABEL: fcvtms_ss_round_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtms s0, s0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtms_ss_round_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtms s0, s0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtms_ss_round_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl floorf
; CHECK-GI-NEXT:    fcvtzs s0, s0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call float @floorf(float %a) nounwind readnone
  %i = fptosi float %r to i32
  %bc = bitcast i32 %i to float
  ret float %bc
}

define double @fcvtms_dd_round_simd(double %a) {
; CHECK-NOFPRCVT-LABEL: fcvtms_dd_round_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtms d0, d0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtms_dd_round_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtms d0, d0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtms_dd_round_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl floor
; CHECK-GI-NEXT:    fcvtzs d0, d0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call double @floor(double %a) nounwind readnone
  %i = fptosi double %r to i64
  %bc = bitcast i64 %i to double
  ret double %bc
}



define double @fcvtmu_ds_round_simd(float %a) {
; CHECK-NOFPRCVT-LABEL: fcvtmu_ds_round_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtmu x8, s0
; CHECK-NOFPRCVT-NEXT:    fmov d0, x8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtmu_ds_round_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtmu d0, s0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtmu_ds_round_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl floorf
; CHECK-GI-NEXT:    fcvtzu d0, s0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call float @floorf(float %a) nounwind readnone
  %i = fptoui float %r to i64
  %bc = bitcast i64 %i to double
  ret double %bc
}

define float @fcvtmu_sd_round_simd(double %a) {
; CHECK-NOFPRCVT-LABEL: fcvtmu_sd_round_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtmu w8, d0
; CHECK-NOFPRCVT-NEXT:    fmov s0, w8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtmu_sd_round_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtmu s0, d0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtmu_sd_round_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl floor
; CHECK-GI-NEXT:    fcvtzu s0, d0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call double @floor(double %a) nounwind readnone
  %i = fptoui double %r to i32
  %bc = bitcast i32 %i to float
  ret float %bc
}

define float @fcvtmu_ss_round_simd(float %a) {
; CHECK-NOFPRCVT-LABEL: fcvtmu_ss_round_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtms s0, s0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtmu_ss_round_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtms s0, s0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtmu_ss_round_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl floorf
; CHECK-GI-NEXT:    fcvtzs s0, s0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call float @floorf(float %a) nounwind readnone
  %i = fptosi float %r to i32
  %bc = bitcast i32 %i to float
  ret float %bc
}

define double @fcvtmu_dd_round_simd(double %a) {
; CHECK-NOFPRCVT-LABEL: fcvtmu_dd_round_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtms d0, d0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtmu_dd_round_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtms d0, d0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtmu_dd_round_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl floor
; CHECK-GI-NEXT:    fcvtzs d0, d0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call double @floor(double %a) nounwind readnone
  %i = fptosi double %r to i64
  %bc = bitcast i64 %i to double
  ret double %bc
}


define double @fcvtps_ds_round_simd(float %a) {
; CHECK-NOFPRCVT-LABEL: fcvtps_ds_round_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtps x8, s0
; CHECK-NOFPRCVT-NEXT:    fmov d0, x8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtps_ds_round_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtps d0, s0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtps_ds_round_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl ceilf
; CHECK-GI-NEXT:    fcvtzs d0, s0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call float @ceilf(float %a) nounwind readnone
  %i = fptosi float %r to i64
  %bc = bitcast i64 %i to double
  ret double %bc
}

define float @fcvtps_sd_round_simd(double %a) {
; CHECK-NOFPRCVT-LABEL: fcvtps_sd_round_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtps w8, d0
; CHECK-NOFPRCVT-NEXT:    fmov s0, w8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtps_sd_round_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtps s0, d0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtps_sd_round_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl ceil
; CHECK-GI-NEXT:    fcvtzs s0, d0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call double @ceil(double %a) nounwind readnone
  %i = fptosi double %r to i32
  %bc = bitcast i32 %i to float
  ret float %bc
}

define float @fcvtps_ss_round_simd(float %a) {
; CHECK-NOFPRCVT-LABEL: fcvtps_ss_round_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtps s0, s0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtps_ss_round_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtps s0, s0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtps_ss_round_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl ceilf
; CHECK-GI-NEXT:    fcvtzs s0, s0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call float @ceilf(float %a) nounwind readnone
  %i = fptosi float %r to i32
  %bc = bitcast i32 %i to float
  ret float %bc
}

define double @fcvtps_dd_round_simd(double %a) {
; CHECK-NOFPRCVT-LABEL: fcvtps_dd_round_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtps d0, d0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtps_dd_round_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtps d0, d0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtps_dd_round_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl ceil
; CHECK-GI-NEXT:    fcvtzs d0, d0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call double @ceil(double %a) nounwind readnone
  %i = fptosi double %r to i64
  %bc = bitcast i64 %i to double
  ret double %bc
}


define double @fcvtpu_ds_round_simd(float %a) {
; CHECK-NOFPRCVT-LABEL: fcvtpu_ds_round_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtpu x8, s0
; CHECK-NOFPRCVT-NEXT:    fmov d0, x8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtpu_ds_round_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtpu d0, s0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtpu_ds_round_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl ceilf
; CHECK-GI-NEXT:    fcvtzu d0, s0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call float @ceilf(float %a) nounwind readnone
  %i = fptoui float %r to i64
  %bc = bitcast i64 %i to double
  ret double %bc
}

define float @fcvtpu_sd_round_simd(double %a) {
; CHECK-NOFPRCVT-LABEL: fcvtpu_sd_round_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtpu w8, d0
; CHECK-NOFPRCVT-NEXT:    fmov s0, w8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtpu_sd_round_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtpu s0, d0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtpu_sd_round_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl ceil
; CHECK-GI-NEXT:    fcvtzu s0, d0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call double @ceil(double %a) nounwind readnone
  %i = fptoui double %r to i32
  %bc = bitcast i32 %i to float
  ret float %bc
}

define float @fcvtpu_ss_round_simd(float %a) {
; CHECK-NOFPRCVT-LABEL: fcvtpu_ss_round_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtps s0, s0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtpu_ss_round_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtps s0, s0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtpu_ss_round_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl ceilf
; CHECK-GI-NEXT:    fcvtzs s0, s0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call float @ceilf(float %a) nounwind readnone
  %i = fptosi float %r to i32
  %bc = bitcast i32 %i to float
  ret float %bc
}

define double @fcvtpu_dd_round_simd(double %a) {
; CHECK-NOFPRCVT-LABEL: fcvtpu_dd_round_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtps d0, d0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtpu_dd_round_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtps d0, d0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtpu_dd_round_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl ceil
; CHECK-GI-NEXT:    fcvtzs d0, d0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call double @ceil(double %a) nounwind readnone
  %i = fptosi double %r to i64
  %bc = bitcast i64 %i to double
  ret double %bc
}


define double @fcvtzs_ds_round_simd(float %a) {
; CHECK-NOFPRCVT-LABEL: fcvtzs_ds_round_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzs x8, s0
; CHECK-NOFPRCVT-NEXT:    fmov d0, x8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtzs_ds_round_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtzs d0, s0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtzs_ds_round_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl truncf
; CHECK-GI-NEXT:    fcvtzs d0, s0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call float @truncf(float %a) nounwind readnone
  %i = fptosi float %r to i64
  %bc = bitcast i64 %i to double
  ret double %bc
}

define float @fcvtzs_sd_round_simd(double %a) {
; CHECK-NOFPRCVT-LABEL: fcvtzs_sd_round_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzs w8, d0
; CHECK-NOFPRCVT-NEXT:    fmov s0, w8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtzs_sd_round_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtzs s0, d0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtzs_sd_round_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl trunc
; CHECK-GI-NEXT:    fcvtzs s0, d0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call double @trunc(double %a) nounwind readnone
  %i = fptosi double %r to i32
  %bc = bitcast i32 %i to float
  ret float %bc
}

define float @fcvtzs_ss_round_simd(float %a) {
; CHECK-NOFPRCVT-LABEL: fcvtzs_ss_round_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzs s0, s0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtzs_ss_round_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtzs s0, s0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtzs_ss_round_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl truncf
; CHECK-GI-NEXT:    fcvtzs s0, s0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call float @truncf(float %a) nounwind readnone
  %i = fptosi float %r to i32
  %bc = bitcast i32 %i to float
  ret float %bc
}

define double @fcvtzs_dd_round_simd(double %a) {
; CHECK-NOFPRCVT-LABEL: fcvtzs_dd_round_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzs d0, d0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtzs_dd_round_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtzs d0, d0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtzs_dd_round_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl trunc
; CHECK-GI-NEXT:    fcvtzs d0, d0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call double @trunc(double %a) nounwind readnone
  %i = fptosi double %r to i64
  %bc = bitcast i64 %i to double
  ret double %bc
}

define double @fcvtzu_ds_round_simd(float %a) {
; CHECK-NOFPRCVT-LABEL: fcvtzu_ds_round_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzu x8, s0
; CHECK-NOFPRCVT-NEXT:    fmov d0, x8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtzu_ds_round_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtzu d0, s0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtzu_ds_round_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl truncf
; CHECK-GI-NEXT:    fcvtzu d0, s0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call float @truncf(float %a) nounwind readnone
  %i = fptoui float %r to i64
  %bc = bitcast i64 %i to double
  ret double %bc
}

define float @fcvtzu_sd_round_simd(double %a) {
; CHECK-NOFPRCVT-LABEL: fcvtzu_sd_round_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzu w8, d0
; CHECK-NOFPRCVT-NEXT:    fmov s0, w8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtzu_sd_round_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtzu s0, d0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtzu_sd_round_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl trunc
; CHECK-GI-NEXT:    fcvtzu s0, d0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call double @trunc(double %a) nounwind readnone
  %i = fptoui double %r to i32
  %bc = bitcast i32 %i to float
  ret float %bc
}

define float @fcvtzu_ss_round_simd(float %a) {
; CHECK-NOFPRCVT-LABEL: fcvtzu_ss_round_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzs s0, s0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtzu_ss_round_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtzs s0, s0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtzu_ss_round_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl truncf
; CHECK-GI-NEXT:    fcvtzs s0, s0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call float @truncf(float %a) nounwind readnone
  %i = fptosi float %r to i32
  %bc = bitcast i32 %i to float
  ret float %bc
}

define double @fcvtzu_dd_round_simd(double %a) {
; CHECK-NOFPRCVT-LABEL: fcvtzu_dd_round_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzs d0, d0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtzu_dd_round_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtzs d0, d0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtzu_dd_round_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl trunc
; CHECK-GI-NEXT:    fcvtzs d0, d0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call double @trunc(double %a) nounwind readnone
  %i = fptosi double %r to i64
  %bc = bitcast i64 %i to double
  ret double %bc
}


;
; FPTOI saturating
;

define float @fcvtzs_sh_sat_simd(half %a) {
; CHECK-NOFPRCVT-LABEL: fcvtzs_sh_sat_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzs w8, h0
; CHECK-NOFPRCVT-NEXT:    fmov s0, w8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-LABEL: fcvtzs_sh_sat_simd:
; CHECK:       // %bb.0:
; CHECK-NEXT:    fcvtzs s0, h0
; CHECK-NEXT:    ret
  %i = call i32 @llvm.fptosi.sat.i32.f16(half %a)
  %bc = bitcast i32 %i to float
  ret float %bc
}

define double @fcvtzs_dh_sat_simd(half %a) {
; CHECK-NOFPRCVT-LABEL: fcvtzs_dh_sat_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzs x8, h0
; CHECK-NOFPRCVT-NEXT:    fmov d0, x8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-LABEL: fcvtzs_dh_sat_simd:
; CHECK:       // %bb.0:
; CHECK-NEXT:    fcvtzs d0, h0
; CHECK-NEXT:    ret
  %i = call i64 @llvm.fptosi.sat.i64.f16(half %a)
  %bc = bitcast i64 %i to double
  ret double %bc
}

define double @fcvtzs_ds_sat_simd(float %a) {
; CHECK-NOFPRCVT-LABEL: fcvtzs_ds_sat_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzs x8, s0
; CHECK-NOFPRCVT-NEXT:    fmov d0, x8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-LABEL: fcvtzs_ds_sat_simd:
; CHECK:       // %bb.0:
; CHECK-NEXT:    fcvtzs d0, s0
; CHECK-NEXT:    ret
  %i = call i64 @llvm.fptosi.sat.i64.f32(float %a)
  %bc = bitcast i64 %i to double
  ret double %bc
}

define float @fcvtzs_sd_sat_simd(double %a) {
; CHECK-NOFPRCVT-LABEL: fcvtzs_sd_sat_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzs w8, d0
; CHECK-NOFPRCVT-NEXT:    fmov s0, w8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-LABEL: fcvtzs_sd_sat_simd:
; CHECK:       // %bb.0:
; CHECK-NEXT:    fcvtzs s0, d0
; CHECK-NEXT:    ret
  %i = call i32 @llvm.fptosi.sat.i32.f64(double %a)
  %bc = bitcast i32 %i to float
  ret float %bc
}

define float @fcvtzs_ss_sat_simd(float %a) {
; CHECK-NOFPRCVT-LABEL: fcvtzs_ss_sat_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzs s0, s0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-LABEL: fcvtzs_ss_sat_simd:
; CHECK:       // %bb.0:
; CHECK-NEXT:    fcvtzs s0, s0
; CHECK-NEXT:    ret
  %i = call i32 @llvm.fptosi.sat.i32.f32(float %a)
  %bc = bitcast i32 %i to float
  ret float %bc
}

define double @fcvtzs_dd_sat_simd(double %a) {
; CHECK-NOFPRCVT-LABEL: fcvtzs_dd_sat_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzs d0, d0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-LABEL: fcvtzs_dd_sat_simd:
; CHECK:       // %bb.0:
; CHECK-NEXT:    fcvtzs d0, d0
; CHECK-NEXT:    ret
  %i = call i64 @llvm.fptosi.sat.i64.f64(double %a)
  %bc = bitcast i64 %i to double
  ret double %bc
}

define float @fcvtzu_sh_sat_simd(half %a) {
; CHECK-NOFPRCVT-LABEL: fcvtzu_sh_sat_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzu w8, h0
; CHECK-NOFPRCVT-NEXT:    fmov s0, w8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-LABEL: fcvtzu_sh_sat_simd:
; CHECK:       // %bb.0:
; CHECK-NEXT:    fcvtzu s0, h0
; CHECK-NEXT:    ret
  %i = call i32 @llvm.fptoui.sat.i32.f16(half %a)
  %bc = bitcast i32 %i to float
  ret float %bc
}

define double @fcvtzu_dh_sat_simd(half %a) {
; CHECK-NOFPRCVT-LABEL: fcvtzu_dh_sat_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzu x8, h0
; CHECK-NOFPRCVT-NEXT:    fmov d0, x8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-LABEL: fcvtzu_dh_sat_simd:
; CHECK:       // %bb.0:
; CHECK-NEXT:    fcvtzu d0, h0
; CHECK-NEXT:    ret
  %i = call i64 @llvm.fptoui.sat.i64.f16(half %a)
  %bc = bitcast i64 %i to double
  ret double %bc
}

define double @fcvtzu_ds_sat_simd(float %a) {
; CHECK-NOFPRCVT-LABEL: fcvtzu_ds_sat_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzu x8, s0
; CHECK-NOFPRCVT-NEXT:    fmov d0, x8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-LABEL: fcvtzu_ds_sat_simd:
; CHECK:       // %bb.0:
; CHECK-NEXT:    fcvtzu d0, s0
; CHECK-NEXT:    ret
  %i = call i64 @llvm.fptoui.sat.i64.f32(float %a)
  %bc = bitcast i64 %i to double
  ret double %bc
}

define float @fcvtzu_sd_sat_simd(double %a) {
; CHECK-NOFPRCVT-LABEL: fcvtzu_sd_sat_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzu w8, d0
; CHECK-NOFPRCVT-NEXT:    fmov s0, w8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-LABEL: fcvtzu_sd_sat_simd:
; CHECK:       // %bb.0:
; CHECK-NEXT:    fcvtzu s0, d0
; CHECK-NEXT:    ret
  %i = call i32 @llvm.fptoui.sat.i32.f64(double %a)
  %bc = bitcast i32 %i to float
  ret float %bc
}

define float @fcvtzu_ss_sat_simd(float %a) {
; CHECK-NOFPRCVT-LABEL: fcvtzu_ss_sat_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzs s0, s0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-LABEL: fcvtzu_ss_sat_simd:
; CHECK:       // %bb.0:
; CHECK-NEXT:    fcvtzs s0, s0
; CHECK-NEXT:    ret
  %i = call i32 @llvm.fptosi.sat.i32.f32(float %a)
  %bc = bitcast i32 %i to float
  ret float %bc
}

define double @fcvtzu_dd_sat_simd(double %a) {
; CHECK-NOFPRCVT-LABEL: fcvtzu_dd_sat_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzs d0, d0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-LABEL: fcvtzu_dd_sat_simd:
; CHECK:       // %bb.0:
; CHECK-NEXT:    fcvtzs d0, d0
; CHECK-NEXT:    ret
  %i = call i64 @llvm.fptosi.sat.i64.f64(double %a)
  %bc = bitcast i64 %i to double
  ret double %bc
}

;
; FPTOI saturating with rounding
;

define float @fcvtas_sh_simd(half %a) {
; CHECK-NOFPRCVT-LABEL: fcvtas_sh_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtas w8, h0
; CHECK-NOFPRCVT-NEXT:    fmov s0, w8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtas_sh_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtas s0, h0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtas_sh_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    frinta h0, h0
; CHECK-GI-NEXT:    fcvtzs s0, h0
; CHECK-GI-NEXT:    ret
  %r = call half @llvm.round.f16(half %a) nounwind readnone
  %i = call i32 @llvm.fptosi.sat.i32.f16(half %r)
  %bc = bitcast i32 %i to float
  ret float %bc
}

define double @fcvtas_dh_simd(half %a) {
; CHECK-NOFPRCVT-LABEL: fcvtas_dh_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtas x8, h0
; CHECK-NOFPRCVT-NEXT:    fmov d0, x8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtas_dh_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtas d0, h0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtas_dh_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    frinta h0, h0
; CHECK-GI-NEXT:    fcvtzs d0, h0
; CHECK-GI-NEXT:    ret
  %r = call half @llvm.round.f16(half %a) nounwind readnone
  %i = call i64 @llvm.fptosi.sat.i64.f16(half %r)
  %bc = bitcast i64 %i to double
  ret double %bc
}

define double @fcvtas_ds_simd(float %a) {
; CHECK-NOFPRCVT-LABEL: fcvtas_ds_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtas x8, s0
; CHECK-NOFPRCVT-NEXT:    fmov d0, x8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtas_ds_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtas d0, s0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtas_ds_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl roundf
; CHECK-GI-NEXT:    fcvtzs d0, s0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call float @roundf(float %a) nounwind readnone
  %i = call i64 @llvm.fptosi.sat.i64.f32(float %r)
  %bc = bitcast i64 %i to double
  ret double %bc
}

define float @fcvtas_sd_simd(double %a) {
; CHECK-NOFPRCVT-LABEL: fcvtas_sd_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtas w8, d0
; CHECK-NOFPRCVT-NEXT:    fmov s0, w8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtas_sd_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtas s0, d0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtas_sd_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl round
; CHECK-GI-NEXT:    fcvtzs s0, d0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call double @round(double %a) nounwind readnone
  %i = call i32 @llvm.fptosi.sat.i32.f64(double %r)
  %bc = bitcast i32 %i to float
  ret float %bc
}

define float @fcvtas_ss_simd(float %a) {
; CHECK-NOFPRCVT-LABEL: fcvtas_ss_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtas s0, s0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtas_ss_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtas s0, s0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtas_ss_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl roundf
; CHECK-GI-NEXT:    fcvtzs s0, s0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call float @roundf(float %a) nounwind readnone
  %i = call i32 @llvm.fptosi.sat.i32.f32(float %r)
  %bc = bitcast i32 %i to float
  ret float %bc
}

define double @fcvtas_dd_simd(double %a) {
; CHECK-NOFPRCVT-LABEL: fcvtas_dd_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtas d0, d0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtas_dd_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtas d0, d0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtas_dd_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl round
; CHECK-GI-NEXT:    fcvtzs d0, d0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call double @round(double %a) nounwind readnone
  %i = call i64 @llvm.fptosi.sat.i64.f64(double %r)
  %bc = bitcast i64 %i to double
  ret double %bc
}

define float @fcvtau_sh_simd(half %a) {
; CHECK-NOFPRCVT-LABEL: fcvtau_sh_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtau w8, h0
; CHECK-NOFPRCVT-NEXT:    fmov s0, w8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtau_sh_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtau s0, h0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtau_sh_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    frinta h0, h0
; CHECK-GI-NEXT:    fcvtzu s0, h0
; CHECK-GI-NEXT:    ret
  %r = call half @llvm.round.f16(half %a) nounwind readnone
  %i = call i32 @llvm.fptoui.sat.i32.f16(half %r)
  %bc = bitcast i32 %i to float
  ret float %bc
}

define double @fcvtau_dh_simd(half %a) {
; CHECK-NOFPRCVT-LABEL: fcvtau_dh_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtau x8, h0
; CHECK-NOFPRCVT-NEXT:    fmov d0, x8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtau_dh_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtau d0, h0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtau_dh_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    frinta h0, h0
; CHECK-GI-NEXT:    fcvtzu d0, h0
; CHECK-GI-NEXT:    ret
  %r = call half @llvm.round.f16(half %a) nounwind readnone
  %i = call i64 @llvm.fptoui.sat.i64.f16(half %r)
  %bc = bitcast i64 %i to double
  ret double %bc
}

define double @fcvtau_ds_simd(float %a) {
; CHECK-NOFPRCVT-LABEL: fcvtau_ds_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtau x8, s0
; CHECK-NOFPRCVT-NEXT:    fmov d0, x8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtau_ds_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtau d0, s0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtau_ds_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl roundf
; CHECK-GI-NEXT:    fcvtzu d0, s0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call float @roundf(float %a) nounwind readnone
  %i = call i64 @llvm.fptoui.sat.i64.f32(float %r)
  %bc = bitcast i64 %i to double
  ret double %bc
}

define float @fcvtau_sd_simd(double %a) {
; CHECK-NOFPRCVT-LABEL: fcvtau_sd_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtau w8, d0
; CHECK-NOFPRCVT-NEXT:    fmov s0, w8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtau_sd_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtau s0, d0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtau_sd_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl round
; CHECK-GI-NEXT:    fcvtzu s0, d0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call double @round(double %a) nounwind readnone
  %i = call i32 @llvm.fptoui.sat.i32.f64(double %r)
  %bc = bitcast i32 %i to float
  ret float %bc
}

define float @fcvtau_ss_simd(float %a) {
; CHECK-NOFPRCVT-LABEL: fcvtau_ss_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtas s0, s0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtau_ss_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtas s0, s0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtau_ss_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl roundf
; CHECK-GI-NEXT:    fcvtzs s0, s0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call float @roundf(float %a) nounwind readnone
  %i = call i32 @llvm.fptosi.sat.i32.f32(float %r)
  %bc = bitcast i32 %i to float
  ret float %bc
}

define double @fcvtau_dd_simd(double %a) {
; CHECK-NOFPRCVT-LABEL: fcvtau_dd_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtas d0, d0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtau_dd_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtas d0, d0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtau_dd_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl round
; CHECK-GI-NEXT:    fcvtzs d0, d0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call double @round(double %a) nounwind readnone
  %i = call i64 @llvm.fptosi.sat.i64.f64(double %r)
  %bc = bitcast i64 %i to double
  ret double %bc
}

define float @fcvtms_sh_simd(half %a) {
; CHECK-NOFPRCVT-LABEL: fcvtms_sh_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtms w8, h0
; CHECK-NOFPRCVT-NEXT:    fmov s0, w8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtms_sh_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtms s0, h0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtms_sh_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    frintm h0, h0
; CHECK-GI-NEXT:    fcvtzs s0, h0
; CHECK-GI-NEXT:    ret
  %r = call half @llvm.floor.f16(half %a) nounwind readnone
  %i = call i32 @llvm.fptosi.sat.i32.f16(half %r)
  %bc = bitcast i32 %i to float
  ret float %bc
}

define double @fcvtms_dh_simd(half %a) {
; CHECK-NOFPRCVT-LABEL: fcvtms_dh_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtms x8, h0
; CHECK-NOFPRCVT-NEXT:    fmov d0, x8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtms_dh_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtms d0, h0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtms_dh_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    frintm h0, h0
; CHECK-GI-NEXT:    fcvtzs d0, h0
; CHECK-GI-NEXT:    ret
  %r = call half @llvm.floor.f16(half %a) nounwind readnone
  %i = call i64 @llvm.fptosi.sat.i64.f16(half %r)
  %bc = bitcast i64 %i to double
  ret double %bc
}

define double @fcvtms_ds_simd(float %a) {
; CHECK-NOFPRCVT-LABEL: fcvtms_ds_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtms x8, s0
; CHECK-NOFPRCVT-NEXT:    fmov d0, x8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtms_ds_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtms d0, s0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtms_ds_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl floorf
; CHECK-GI-NEXT:    fcvtzs d0, s0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call float @floorf(float %a) nounwind readnone
  %i = call i64 @llvm.fptosi.sat.i64.f32(float %r)
  %bc = bitcast i64 %i to double
  ret double %bc
}

define float @fcvtms_sd_simd(double %a) {
; CHECK-NOFPRCVT-LABEL: fcvtms_sd_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtms w8, d0
; CHECK-NOFPRCVT-NEXT:    fmov s0, w8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtms_sd_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtms s0, d0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtms_sd_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl floor
; CHECK-GI-NEXT:    fcvtzs s0, d0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call double @floor(double %a) nounwind readnone
  %i = call i32 @llvm.fptosi.sat.i32.f64(double %r)
  %bc = bitcast i32 %i to float
  ret float %bc
}

define float @fcvtms_ss_simd(float %a) {
; CHECK-NOFPRCVT-LABEL: fcvtms_ss_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtms s0, s0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtms_ss_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtms s0, s0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtms_ss_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl floorf
; CHECK-GI-NEXT:    fcvtzs s0, s0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call float @floorf(float %a) nounwind readnone
  %i = call i32 @llvm.fptosi.sat.i32.f32(float %r)
  %bc = bitcast i32 %i to float
  ret float %bc
}

define double @fcvtms_dd_simd(double %a) {
; CHECK-NOFPRCVT-LABEL: fcvtms_dd_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtms d0, d0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtms_dd_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtms d0, d0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtms_dd_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl floor
; CHECK-GI-NEXT:    fcvtzs d0, d0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call double @floor(double %a) nounwind readnone
  %i = call i64 @llvm.fptosi.sat.i64.f64(double %r)
  %bc = bitcast i64 %i to double
  ret double %bc
}

define float @fcvtmu_sh_simd(half %a) {
; CHECK-NOFPRCVT-LABEL: fcvtmu_sh_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtmu w8, h0
; CHECK-NOFPRCVT-NEXT:    fmov s0, w8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtmu_sh_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtmu s0, h0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtmu_sh_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    frintm h0, h0
; CHECK-GI-NEXT:    fcvtzu s0, h0
; CHECK-GI-NEXT:    ret
  %r = call half @llvm.floor.f16(half %a) nounwind readnone
  %i = call i32 @llvm.fptoui.sat.i32.f16(half %r)
  %bc = bitcast i32 %i to float
  ret float %bc
}

define double @fcvtmu_dh_simd(half %a) {
; CHECK-NOFPRCVT-LABEL: fcvtmu_dh_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtmu x8, h0
; CHECK-NOFPRCVT-NEXT:    fmov d0, x8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtmu_dh_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtmu d0, h0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtmu_dh_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    frintm h0, h0
; CHECK-GI-NEXT:    fcvtzu d0, h0
; CHECK-GI-NEXT:    ret
  %r = call half @llvm.floor.f16(half %a) nounwind readnone
  %i = call i64 @llvm.fptoui.sat.i64.f16(half %r)
  %bc = bitcast i64 %i to double
  ret double %bc
}

define double @fcvtmu_ds_simd(float %a) {
; CHECK-NOFPRCVT-LABEL: fcvtmu_ds_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtmu x8, s0
; CHECK-NOFPRCVT-NEXT:    fmov d0, x8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtmu_ds_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtmu d0, s0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtmu_ds_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl floorf
; CHECK-GI-NEXT:    fcvtzu d0, s0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call float @floorf(float %a) nounwind readnone
  %i = call i64 @llvm.fptoui.sat.i64.f32(float %r)
  %bc = bitcast i64 %i to double
  ret double %bc
}

define float @fcvtmu_sd_simd(double %a) {
; CHECK-NOFPRCVT-LABEL: fcvtmu_sd_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtmu w8, d0
; CHECK-NOFPRCVT-NEXT:    fmov s0, w8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtmu_sd_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtmu s0, d0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtmu_sd_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl floor
; CHECK-GI-NEXT:    fcvtzu s0, d0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call double @floor(double %a) nounwind readnone
  %i = call i32 @llvm.fptoui.sat.i32.f64(double %r)
  %bc = bitcast i32 %i to float
  ret float %bc
}

define float @fcvtmu_ss_simd(float %a) {
; CHECK-NOFPRCVT-LABEL: fcvtmu_ss_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtms s0, s0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtmu_ss_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtms s0, s0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtmu_ss_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl floorf
; CHECK-GI-NEXT:    fcvtzs s0, s0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call float @floorf(float %a) nounwind readnone
  %i = call i32 @llvm.fptosi.sat.i32.f32(float %r)
  %bc = bitcast i32 %i to float
  ret float %bc
}

define double @fcvtmu_dd_simd(double %a) {
; CHECK-NOFPRCVT-LABEL: fcvtmu_dd_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtms d0, d0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtmu_dd_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtms d0, d0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtmu_dd_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl floor
; CHECK-GI-NEXT:    fcvtzs d0, d0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call double @floor(double %a) nounwind readnone
  %i = call i64 @llvm.fptosi.sat.i64.f64(double %r)
  %bc = bitcast i64 %i to double
  ret double %bc
}

define float @fcvtps_sh_simd(half %a) {
; CHECK-NOFPRCVT-LABEL: fcvtps_sh_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtps w8, h0
; CHECK-NOFPRCVT-NEXT:    fmov s0, w8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtps_sh_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtps s0, h0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtps_sh_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    frintp h0, h0
; CHECK-GI-NEXT:    fcvtzs s0, h0
; CHECK-GI-NEXT:    ret
  %r = call half @llvm.ceil.f16(half %a) nounwind readnone
  %i = call i32 @llvm.fptosi.sat.i32.f16(half %r)
  %bc = bitcast i32 %i to float
  ret float %bc
}

define double @fcvtps_dh_simd(half %a) {
; CHECK-NOFPRCVT-LABEL: fcvtps_dh_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtps x8, h0
; CHECK-NOFPRCVT-NEXT:    fmov d0, x8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtps_dh_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtps d0, h0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtps_dh_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    frintp h0, h0
; CHECK-GI-NEXT:    fcvtzs d0, h0
; CHECK-GI-NEXT:    ret
  %r = call half @llvm.ceil.f16(half %a) nounwind readnone
  %i = call i64 @llvm.fptosi.sat.i64.f16(half %r)
  %bc = bitcast i64 %i to double
  ret double %bc
}

define double @fcvtps_ds_simd(float %a) {
; CHECK-NOFPRCVT-LABEL: fcvtps_ds_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtps x8, s0
; CHECK-NOFPRCVT-NEXT:    fmov d0, x8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtps_ds_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtps d0, s0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtps_ds_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl ceilf
; CHECK-GI-NEXT:    fcvtzs d0, s0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call float @ceilf(float %a) nounwind readnone
  %i = call i64 @llvm.fptosi.sat.i64.f32(float %r)
  %bc = bitcast i64 %i to double
  ret double %bc
}

define float @fcvtps_sd_simd(double %a) {
; CHECK-NOFPRCVT-LABEL: fcvtps_sd_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtps w8, d0
; CHECK-NOFPRCVT-NEXT:    fmov s0, w8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtps_sd_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtps s0, d0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtps_sd_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl ceil
; CHECK-GI-NEXT:    fcvtzs s0, d0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call double @ceil(double %a) nounwind readnone
  %i = call i32 @llvm.fptosi.sat.i32.f64(double %r)
  %bc = bitcast i32 %i to float
  ret float %bc
}

define float @fcvtps_ss_simd(float %a) {
; CHECK-NOFPRCVT-LABEL: fcvtps_ss_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtps s0, s0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtps_ss_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtps s0, s0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtps_ss_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl ceilf
; CHECK-GI-NEXT:    fcvtzs s0, s0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call float @ceilf(float %a) nounwind readnone
  %i = call i32 @llvm.fptosi.sat.i32.f32(float %r)
  %bc = bitcast i32 %i to float
  ret float %bc
}

define double @fcvtps_dd_simd(double %a) {
; CHECK-NOFPRCVT-LABEL: fcvtps_dd_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtps d0, d0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtps_dd_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtps d0, d0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtps_dd_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl ceil
; CHECK-GI-NEXT:    fcvtzs d0, d0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call double @ceil(double %a) nounwind readnone
  %i = call i64 @llvm.fptosi.sat.i64.f64(double %r)
  %bc = bitcast i64 %i to double
  ret double %bc
}

define float @fcvtpu_sh_simd(half %a) {
; CHECK-NOFPRCVT-LABEL: fcvtpu_sh_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtpu w8, h0
; CHECK-NOFPRCVT-NEXT:    fmov s0, w8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtpu_sh_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtpu s0, h0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtpu_sh_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    frintp h0, h0
; CHECK-GI-NEXT:    fcvtzu s0, h0
; CHECK-GI-NEXT:    ret
  %r = call half @llvm.ceil.f16(half %a) nounwind readnone
  %i = call i32 @llvm.fptoui.sat.i32.f16(half %r)
  %bc = bitcast i32 %i to float
  ret float %bc
}

define double @fcvtpu_dh_simd(half %a) {
; CHECK-NOFPRCVT-LABEL: fcvtpu_dh_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtpu x8, h0
; CHECK-NOFPRCVT-NEXT:    fmov d0, x8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtpu_dh_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtpu d0, h0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtpu_dh_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    frintp h0, h0
; CHECK-GI-NEXT:    fcvtzu d0, h0
; CHECK-GI-NEXT:    ret
  %r = call half @llvm.ceil.f16(half %a) nounwind readnone
  %i = call i64 @llvm.fptoui.sat.i64.f16(half %r)
  %bc = bitcast i64 %i to double
  ret double %bc
}

define double @fcvtpu_ds_simd(float %a) {
; CHECK-NOFPRCVT-LABEL: fcvtpu_ds_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtpu x8, s0
; CHECK-NOFPRCVT-NEXT:    fmov d0, x8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtpu_ds_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtpu d0, s0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtpu_ds_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl ceilf
; CHECK-GI-NEXT:    fcvtzu d0, s0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call float @ceilf(float %a) nounwind readnone
  %i = call i64 @llvm.fptoui.sat.i64.f32(float %r)
  %bc = bitcast i64 %i to double
  ret double %bc
}

define float @fcvtpu_sd_simd(double %a) {
; CHECK-NOFPRCVT-LABEL: fcvtpu_sd_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtpu w8, d0
; CHECK-NOFPRCVT-NEXT:    fmov s0, w8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtpu_sd_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtpu s0, d0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtpu_sd_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl ceil
; CHECK-GI-NEXT:    fcvtzu s0, d0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call double @ceil(double %a) nounwind readnone
  %i = call i32 @llvm.fptoui.sat.i32.f64(double %r)
  %bc = bitcast i32 %i to float
  ret float %bc
}

define float @fcvtpu_ss_simd(float %a) {
; CHECK-NOFPRCVT-LABEL: fcvtpu_ss_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtps s0, s0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtpu_ss_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtps s0, s0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtpu_ss_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl ceilf
; CHECK-GI-NEXT:    fcvtzs s0, s0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call float @ceilf(float %a) nounwind readnone
  %i = call i32 @llvm.fptosi.sat.i32.f32(float %r)
  %bc = bitcast i32 %i to float
  ret float %bc
}

define double @fcvtpu_dd_simd(double %a) {
; CHECK-NOFPRCVT-LABEL: fcvtpu_dd_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtps d0, d0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtpu_dd_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtps d0, d0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtpu_dd_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl ceil
; CHECK-GI-NEXT:    fcvtzs d0, d0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call double @ceil(double %a) nounwind readnone
  %i = call i64 @llvm.fptosi.sat.i64.f64(double %r)
  %bc = bitcast i64 %i to double
  ret double %bc
}

define float @fcvtzs_sh_simd(half %a) {
; CHECK-NOFPRCVT-LABEL: fcvtzs_sh_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzs w8, h0
; CHECK-NOFPRCVT-NEXT:    fmov s0, w8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtzs_sh_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtzs s0, h0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtzs_sh_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    frintz h0, h0
; CHECK-GI-NEXT:    fcvtzs s0, h0
; CHECK-GI-NEXT:    ret
  %r = call half @llvm.trunc.f16(half %a) nounwind readnone
  %i = call i32 @llvm.fptosi.sat.i32.f16(half %r)
  %bc = bitcast i32 %i to float
  ret float %bc
}

define double @fcvtzs_dh_simd(half %a) {
; CHECK-NOFPRCVT-LABEL: fcvtzs_dh_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzs x8, h0
; CHECK-NOFPRCVT-NEXT:    fmov d0, x8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtzs_dh_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtzs d0, h0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtzs_dh_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    frintz h0, h0
; CHECK-GI-NEXT:    fcvtzs d0, h0
; CHECK-GI-NEXT:    ret
  %r = call half @llvm.trunc.f16(half %a) nounwind readnone
  %i = call i64 @llvm.fptosi.sat.i64.f16(half %r)
  %bc = bitcast i64 %i to double
  ret double %bc
}

define double @fcvtzs_ds_simd(float %a) {
; CHECK-NOFPRCVT-LABEL: fcvtzs_ds_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzs x8, s0
; CHECK-NOFPRCVT-NEXT:    fmov d0, x8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtzs_ds_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtzs d0, s0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtzs_ds_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl truncf
; CHECK-GI-NEXT:    fcvtzs d0, s0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call float @truncf(float %a) nounwind readnone
  %i = call i64 @llvm.fptosi.sat.i64.f32(float %r)
  %bc = bitcast i64 %i to double
  ret double %bc
}

define float @fcvtzs_sd_simd(double %a) {
; CHECK-NOFPRCVT-LABEL: fcvtzs_sd_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzs w8, d0
; CHECK-NOFPRCVT-NEXT:    fmov s0, w8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtzs_sd_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtzs s0, d0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtzs_sd_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl trunc
; CHECK-GI-NEXT:    fcvtzs s0, d0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call double @trunc(double %a) nounwind readnone
  %i = call i32 @llvm.fptosi.sat.i32.f64(double %r)
  %bc = bitcast i32 %i to float
  ret float %bc
}

define float @fcvtzs_ss_simd(float %a) {
; CHECK-NOFPRCVT-LABEL: fcvtzs_ss_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzs s0, s0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtzs_ss_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtzs s0, s0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtzs_ss_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl truncf
; CHECK-GI-NEXT:    fcvtzs s0, s0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call float @truncf(float %a) nounwind readnone
  %i = call i32 @llvm.fptosi.sat.i32.f32(float %r)
  %bc = bitcast i32 %i to float
  ret float %bc
}

define double @fcvtzs_dd_simd(double %a) {
; CHECK-NOFPRCVT-LABEL: fcvtzs_dd_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzs d0, d0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtzs_dd_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtzs d0, d0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtzs_dd_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl trunc
; CHECK-GI-NEXT:    fcvtzs d0, d0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call double @trunc(double %a) nounwind readnone
  %i = call i64 @llvm.fptosi.sat.i64.f64(double %r)
  %bc = bitcast i64 %i to double
  ret double %bc
}

define float @fcvtzu_sh_simd(half %a) {
; CHECK-NOFPRCVT-LABEL: fcvtzu_sh_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzu w8, h0
; CHECK-NOFPRCVT-NEXT:    fmov s0, w8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtzu_sh_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtzu s0, h0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtzu_sh_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    frintz h0, h0
; CHECK-GI-NEXT:    fcvtzu s0, h0
; CHECK-GI-NEXT:    ret
  %r = call half @llvm.trunc.f16(half %a) nounwind readnone
  %i = call i32 @llvm.fptoui.sat.i32.f16(half %r)
  %bc = bitcast i32 %i to float
  ret float %bc
}

define double @fcvtzu_dh_simd(half %a) {
; CHECK-NOFPRCVT-LABEL: fcvtzu_dh_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzu x8, h0
; CHECK-NOFPRCVT-NEXT:    fmov d0, x8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtzu_dh_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtzu d0, h0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtzu_dh_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    frintz h0, h0
; CHECK-GI-NEXT:    fcvtzu d0, h0
; CHECK-GI-NEXT:    ret
  %r = call half @llvm.trunc.f16(half %a) nounwind readnone
  %i = call i64 @llvm.fptoui.sat.i64.f16(half %r)
  %bc = bitcast i64 %i to double
  ret double %bc
}

define double @fcvtzu_ds_simd(float %a) {
; CHECK-NOFPRCVT-LABEL: fcvtzu_ds_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzu x8, s0
; CHECK-NOFPRCVT-NEXT:    fmov d0, x8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtzu_ds_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtzu d0, s0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtzu_ds_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl truncf
; CHECK-GI-NEXT:    fcvtzu d0, s0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call float @truncf(float %a) nounwind readnone
  %i = call i64 @llvm.fptoui.sat.i64.f32(float %r)
  %bc = bitcast i64 %i to double
  ret double %bc
}

define float @fcvtzu_sd_simd(double %a) {
; CHECK-NOFPRCVT-LABEL: fcvtzu_sd_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzu w8, d0
; CHECK-NOFPRCVT-NEXT:    fmov s0, w8
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtzu_sd_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtzu s0, d0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtzu_sd_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl trunc
; CHECK-GI-NEXT:    fcvtzu s0, d0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call double @trunc(double %a) nounwind readnone
  %i = call i32 @llvm.fptoui.sat.i32.f64(double %r)
  %bc = bitcast i32 %i to float
  ret float %bc
}

define float @fcvtzu_ss_simd(float %a) {
; CHECK-NOFPRCVT-LABEL: fcvtzu_ss_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzu s0, s0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtzu_ss_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtzu s0, s0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtzu_ss_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl truncf
; CHECK-GI-NEXT:    fcvtzu s0, s0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call float @truncf(float %a) nounwind readnone
  %i = call i32 @llvm.fptoui.sat.i32.f32(float %r)
  %bc = bitcast i32 %i to float
  ret float %bc
}

define double @fcvtzu_dd_simd(double %a) {
; CHECK-NOFPRCVT-LABEL: fcvtzu_dd_simd:
; CHECK-NOFPRCVT:       // %bb.0:
; CHECK-NOFPRCVT-NEXT:    fcvtzu d0, d0
; CHECK-NOFPRCVT-NEXT:    ret
;
; CHECK-SD-LABEL: fcvtzu_dd_simd:
; CHECK-SD:       // %bb.0:
; CHECK-SD-NEXT:    fcvtzu d0, d0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: fcvtzu_dd_simd:
; CHECK-GI:       // %bb.0:
; CHECK-GI-NEXT:    str x30, [sp, #-16]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 16
; CHECK-GI-NEXT:    .cfi_offset w30, -16
; CHECK-GI-NEXT:    bl trunc
; CHECK-GI-NEXT:    fcvtzu d0, d0
; CHECK-GI-NEXT:    ldr x30, [sp], #16 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
  %r = call double @trunc(double %a) nounwind readnone
  %i = call i64 @llvm.fptoui.sat.i64.f64(double %r)
  %bc = bitcast i64 %i to double
  ret double %bc
}

declare half @llvm.floor.f16(half) nounwind readnone
declare half @llvm.ceil.f16(half) nounwind readnone
declare half @llvm.trunc.f16(half) nounwind readnone
declare half @llvm.round.f16(half) nounwind readnone
declare float @floorf(float) nounwind readnone
declare float @ceilf(float) nounwind readnone
declare float @truncf(float) nounwind readnone
declare float @roundf(float) nounwind readnone
declare double @floor(double) nounwind readnone
declare double @ceil(double) nounwind readnone
declare double @trunc(double) nounwind readnone
declare double @round(double) nounwind readnone
